<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- 
       场景：异步请求先A 再B 再C...
       例如：根据用户ID 得到角色A，根据角色，在请求对应权限B
       
       promise：承诺。 未来某个时间节点反馈数据给你。
       promises 有三种状态：pending（进行中）、fulfilled(已成功)和rejected（已失败）
       改变方式
       要么是进行中到成功
       要么是进行中到失败
       状态一旦确定不会在变!!!

    -->
    <script>
        {
            let promise = new Promise ((resolve,reject)=>{
                // resolve成功要执行的函数
                // reject失败要执行的函数
                console.log("promise---承诺");
                setTimeout(() => {
                    // resolve("一直在一起");
                    reject("分手了修复了这个bug");
                }, 3000);
            });
            console.log("1:",promise);
            // 通过then接受异步的结果
            promise.then(res=()=>{
                // 成功了执行这里
                console.log("res:",res);
                console.log("2",promise);
            },err=>{
                // 失败了执行这里
                console.log("err:",err); 
                console.log("2:",promise);
            })

        }

     {
        // 模拟先A  再B 再C
        // then ()可以链式操作
        let ajax = (url,data) =>{
            return new Promise((resolve,reject) =>{
                // 定时器只是为了模拟异步时长
                setTimeout(() => {
                    console.log("请求",url);
                    resolve();
                }, 2000);
            })
        }

        ajax("/A").then(res=>{
            console.log("A请求响应的结果是...");
            return ajax("/B");
        }).then(res =>{
            console.log("B请求响应的结果是...");
            return ajax("/C");
        }).then(res =>{
            console.log("/C请求响应的结果是...");
        })
        
     }
    </script>
</body>
</html>